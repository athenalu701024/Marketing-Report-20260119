<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡ŒéŠ·éƒ¨é–€ AI æ•ˆèƒ½èˆ‡å·¥å…·æˆ°ç•¥å„€è¡¨æ¿</title>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        :root {
            --bg-color: #ffffff;
            --card-bg: #f8fafc;
            --border-color: #e2e8f0;
            --text-main: #1e293b;
            --text-sub: #64748b;
            --cat-text: #3b82f6; --cat-vis: #a855f7; --cat-ops: #f59e0b;
            --proj-color: #00897B; --digi-color: #0284c7; --over-color: #d97706; --art-color: #9333ea;
        }

        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--bg-color); color: var(--text-main); margin: 0; padding: 40px; padding-bottom: 100px; }
        .container { max-width: 1400px; margin: 0 auto; }

        header { margin-bottom: 30px; border-bottom: 2px solid var(--border-color); padding-bottom: 20px; display: flex; justify-content: space-between; align-items: flex-end; }
        h1 { margin: 0; font-size: 36px; color: #0f172a; font-weight: 800; }
        .subtitle { color: var(--text-sub); margin-top: 5px; font-size: 16px; }

        .tool-section { display: grid; grid-template-columns: 1fr 1.4fr 1fr; gap: 25px; margin-bottom: 40px; }
        .tool-card { background: #ffffff; padding: 25px; border-radius: 16px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); display: flex; flex-direction: column; }
        
        .tool-split-container { display: flex; gap: 25px; height: 100%; }
        .tool-sub-list { flex: 1; display: flex; flex-direction: column; }
        .tool-sub-header { font-size: 13px; font-weight: 700; color: #94a3b8; border-bottom: 2px solid #f1f5f9; padding-bottom: 8px; margin-bottom: 12px; display: flex; align-items: center; gap: 6px; }
        
        /* Rank Only Styles */
        .tool-list-item { display: flex; align-items: center; padding: 8px 0; border-bottom: 1px dashed #f1f5f9; }
        .tool-list-item:last-child { border-bottom: none; }
        .tool-rank { font-weight: 800; color: #cbd5e1; width: 30px; font-size: 14px; text-align: center; margin-right: 10px; }
        .tool-name { font-weight: 600; display: flex; align-items: center; gap: 8px; font-size: 14px; color: #334155; }

        .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px; }
        .kpi-card { background: #ffffff; padding: 20px; border-radius: 12px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); text-align: center; }
        .kpi-title { font-size: 14px; color: var(--text-sub); font-weight: 500; }
        .kpi-value { font-size: 42px; font-weight: 800; color: #0f172a; margin: 10px 0; }
        .kpi-note { font-size: 13px; color: #10b981; font-weight: 600; }

        .main-chart-section { margin-bottom: 50px; }
        .chart-box { background: #ffffff; padding: 25px; border-radius: 16px; border: 1px solid var(--border-color); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.03); }
        .section-h2 { font-size: 18px; font-weight: 700; margin-bottom: 20px; color: #334155; display: flex; align-items: center; gap: 8px; }
        .chart-container { position: relative; height: 350px; width: 100%; }

        .group-container { display: grid; gap: 40px; }
        .group-card { background: var(--card-bg); border-radius: 16px; border: 1px solid var(--border-color); padding: 30px; overflow: hidden; }
        .group-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #cbd5e1; padding-bottom: 15px; }
        .group-title { font-size: 24px; font-weight: 800; display: flex; align-items: center; gap: 10px; }
        .group-stats { display: flex; gap: 20px; }
        .stat-badge { background: #fff; padding: 8px 16px; border-radius: 8px; border: 1px solid #e2e8f0; font-size: 14px; font-weight: 600; display: flex; flex-direction: column; align-items: center; }
        .stat-badge span { font-size: 18px; font-weight: 800; color: #0f172a; }
        .stat-badge label { font-size: 11px; color: #64748b; font-weight: 400; }
        
        .group-desc-box { background-color: #fff; border-left: 4px solid #cbd5e1; padding: 20px 25px; margin-bottom: 30px; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); }
        .group-desc-title { font-weight: 700; color: #334155; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; font-size: 16px; }
        .group-desc-text { color: #475569; font-size: 15px; line-height: 1.8; text-align: justify; }

        .group-content { display: grid; grid-template-columns: 1.2fr 1fr; gap: 30px; }

        .task-table { width: 100%; border-collapse: collapse; font-size: 14px; }
        .task-table th { text-align: left; color: #64748b; padding: 10px 8px; border-bottom: 2px solid #e2e8f0; font-size: 13px; }
        .task-table td { padding: 12px 8px; border-bottom: 1px solid #e2e8f0; color: #334155; vertical-align: middle; }
        .time-badge { display: inline-block; padding: 3px 8px; border-radius: 4px; font-size: 12px; font-weight: 700; background: #e2e8f0; color: #475569; }
        .time-badge.ai { background: #dcfce7; color: #166534; }
        .diff-badge { color: #10b981; font-weight: 700; font-size: 13px; background: rgba(16, 185, 129, 0.1); padding: 4px 8px; border-radius: 4px; }
        .cat-badge { font-size: 11px; padding: 2px 6px; border-radius: 3px; color: #fff; margin-right: 5px; font-weight: 500; }

        .gallery-wrapper { display: flex; flex-direction: column; gap: 15px; }
        .img-add-btn { border: 2px dashed #cbd5e1; background-color: #fff; border-radius: 12px; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #94a3b8; height: 120px; text-align: center; cursor: pointer; transition: all 0.3s; }
        .img-add-btn:hover { border-color: #0ea5e9; background-color: #e0f2fe; color: #0ea5e9; }
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px; }
        .gallery-item { position: relative; width: 100%; padding-bottom: 100%; border-radius: 8px; overflow: hidden; border: 1px solid #e2e8f0; cursor: zoom-in; background: #fff; transition: transform 0.2s; }
        .gallery-item:hover { transform: scale(1.05); border-color: #0ea5e9; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .gallery-item img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }

        .lightbox { display: none; position: fixed; z-index: 9999; padding-top: 50px; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.9); justify-content: center; align-items: center; }
        .lightbox-content { margin: auto; display: block; max-width: 90%; max-height: 85vh; border-radius: 4px; box-shadow: 0 0 20px rgba(255,255,255,0.2); animation: zoom 0.3s; }
        .lightbox-close { position: absolute; top: 25px; right: 35px; color: #f1f1f1; font-size: 40px; font-weight: bold; transition: 0.3s; cursor: pointer; }
        .lightbox-close:hover { color: #bbb; }
        @keyframes zoom { from {transform:scale(0.8); opacity:0} to {transform:scale(1); opacity:1} }

        .fab-container { position: fixed; bottom: 30px; right: 30px; z-index: 1000; display: flex; flex-direction: column; align-items: end; gap: 10px; }
        .fab-btn { background-color: #0f172a; color: white; border: none; padding: 15px 25px; border-radius: 50px; font-size: 16px; font-weight: 700; box-shadow: 0 10px 25px rgba(0,0,0,0.2); cursor: pointer; transition: transform 0.2s; display: flex; align-items: center; gap: 10px; }
        .fab-btn:hover { transform: translateY(-3px); background-color: #1e293b; }
        .fab-hint { background: rgba(0,0,0,0.7); color: white; padding: 8px 12px; border-radius: 8px; font-size: 12px; margin-bottom: 5px; opacity: 0; animation: fadeIn 2s forwards; animation-delay: 1s; }
        @keyframes fadeIn { to { opacity: 1; } }
    </style>
</head>
<body>

<div id="myLightbox" class="lightbox" onclick="closeLightbox()">
  <span class="lightbox-close">&times;</span>
  <img class="lightbox-content" id="img01">
</div>

<div class="fab-container">
    <div class="fab-hint">æ­¥é©Ÿï¼šä¸Šå‚³å¤šå¼µåœ–ç‰‡ â é»æ“ŠæŒ‰éˆ• â å­˜æª”</div>
    <button class="fab-btn" onclick="saveOfflineFile()"><i class="fa-solid fa-download"></i> åŒ¯å‡ºé›¢ç·šå ±å‘Š</button>
</div>

<div class="container">
    <header>
        <div>
            <h1>è¡ŒéŠ·éƒ¨é–€ AI æ•ˆèƒ½èˆ‡å·¥å…·æˆ°ç•¥å„€è¡¨æ¿</h1>
            <div class="subtitle">ç”¢èƒ½åƒ¹å€¼è½‰å‹ & AI å·¥å…·ç”Ÿæ…‹ç³»åˆ†æ | 2026.01.16</div>
        </div>
        <div style="text-align: right; color: #64748b;">
            <i class="fa-solid fa-layer-group"></i> æ¶µè“‹çµ„åˆ¥ï¼šå°ˆæ¡ˆã€æ•¸ä½ã€æµ·å¤–ã€ç¾è¡“
        </div>
    </header>

    <div class="tool-section">
        <div class="tool-card">
            <div class="section-h2"><i class="fa-solid fa-shapes"></i> AI å·¥å…·æ‡‰ç”¨é¡åˆ¥ä½”æ¯”</div>
            <div style="height: 180px; position: relative;">
                <canvas id="categoryChart"></canvas>
            </div>
            <div style="text-align: center; margin-top: 15px; font-size: 13px; color: #64748b;">
                <span style="color: var(--cat-text)">â— ç­–ç•¥æ–‡æ¡ˆ</span> &nbsp;
                <span style="color: var(--cat-vis)">â— è¦–è¦ºå½±éŸ³</span> &nbsp;
                <span style="color: var(--cat-ops)">â— ç‡Ÿé‹æ•¸æ“š</span>
            </div>
        </div>

        <div class="tool-card">
            <div class="section-h2"><i class="fa-solid fa-trophy"></i> éƒ¨é–€å¸¸ç”¨å·¥å…·ç†±åº¦æ’è¡Œ</div>
            <div class="tool-split-container">
                <div class="tool-sub-list">
                    <div class="tool-sub-header"><i class="fa-solid fa-users"></i> é€šç”¨/ç­–ç•¥çµ„</div>
                    <div id="topToolsGeneral"></div>
                </div>
                <div class="tool-sub-list" style="border-left: 1px solid #f1f5f9; padding-left: 15px;">
                    <div class="tool-sub-header" style="color: var(--art-color);"><i class="fa-solid fa-palette"></i> ç¾è¡“çµ„å°ˆç”¨</div>
                    <div id="topToolsArt"></div>
                </div>
            </div>
        </div>

        <div class="tool-card" style="background: #f1f5f9; border: none; justify-content: center;">
            <div style="margin-bottom: 20px;">
                <h3 style="margin: 0 0 10px 0; color: #334155;">ğŸ’¡ æˆ°ç•¥æ´å¯Ÿ</h3>
                <p style="font-size: 14px; color: #475569; line-height: 1.6;">
                    AI æ‡‰ç”¨å‘ˆç¾é›™è»Œç™¼å±•ï¼šå…¨é«”åŒä»ä¾è³´ <b>Gemini/ChatGPT</b> é€²è¡Œé‚è¼¯èˆ‡æ–‡æ¡ˆç”¢å‡ºï¼›è€Œ<b>ç¾è¡“çµ„</b>å‰‡å»ºç«‹èµ·ç¨ç‰¹çš„è¦–è¦ºç”Ÿæˆç”Ÿæ…‹ç³» (Nanobanana, VEO, ComfyUI)ï¼Œåœ¨ã€Œå¾ç„¡åˆ°æœ‰ã€çš„å‰µæ„ç™¼æƒ³éšæ®µå±•ç¾æ¥µè‡´æ•ˆç‡ï¼Œæœ‰æ•ˆç¸®çŸ­ 50% ä»¥ä¸Šçš„å‰æœŸä½œæ¥­æ™‚é–“ã€‚
                </p>
            </div>
        </div>
    </div>

    <!-- KPI Section: æ•¸å€¼å·²æ”¹ç‚ºæ‰‹å‹•å¡«å¯«ï¼ŒJS ä¸æœƒå†è‡ªå‹•è¦†è“‹ -->
    <div class="kpi-grid">
        <div class="kpi-card">
            <div class="kpi-title">éƒ¨é–€å·¥æ™‚ç¸½é‡‹æ”¾</div>
            <div class="kpi-value" id="totalSaved">1000h+</div>
            <div class="kpi-note">è½‰ç§»è‡³ç­–ç•¥æ€è€ƒ</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-title">å¹³å‡æ•ˆç‡æå‡å€æ•¸</div>
            <div class="kpi-value" style="color: #0ea5e9;" id="avgMultiplier">3.5x</div>
            <div class="kpi-note">é€Ÿåº¦é¡¯è‘—åŠ å¿«</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-title">P1/P2 é«˜åƒ¹å€¼ç”¢èƒ½</div>
            <div class="kpi-value" style="color: #10b981;">+48%</div>
            <div class="kpi-note">ç­–ç•¥/åˆ†æä½”æ¯”æå‡</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-title">ç›¸ç•¶æ–¼è™›æ“¬å¢å“¡</div>
            <div class="kpi-value" style="color: #9333ea;" id="fteGain">+5.0</div>
            <div class="kpi-note">ä½è³‡æ·±ç­–ç•¥è¡ŒéŠ·</div>
        </div>
    </div>

    <!-- Main Chart -->
    <div class="main-chart-section">
        <div class="chart-box">
            <div class="section-h2"><i class="fa-solid fa-chart-pie"></i> å…¨éƒ¨é–€å·¥æ™‚çµæ§‹è³ªè®Š (Before vs After)</div>
            <div class="chart-container"><canvas id="valueShiftChart"></canvas></div>
            <div style="display: flex; justify-content: center; gap: 20px; margin-top: 15px; font-size: 13px; color: #64748b;">
                <span style="display:flex; align-items:center;"><span style="width:10px; height:10px; background:#ef4444; margin-right:5px; border-radius:50%;"></span>å‚³çµ±å·¥æ™‚ P3/P4 (é›œå‹™)</span>
                <span style="display:flex; align-items:center;"><span style="width:10px; height:10px; background:#0369a1; margin-right:5px; border-radius:50%;"></span>å‚³çµ±å·¥æ™‚ P1/P2 (ç­–ç•¥)</span>
            </div>
        </div>
    </div>

    <!-- Group Details -->
    <h2 style="font-size: 22px; color: #0f172a; margin-bottom: 25px; border-left: 6px solid #0f172a; padding-left: 15px;">
        å„çµ„åˆ¥ AI æ‡‰ç”¨ç´°é …èˆ‡æˆæœå±•ç¤º
    </h2>
    <div class="group-container" id="groupContainer">
        <!-- JS Injected -->
    </div>

</div>

<script>
    // --- Data Definitions (Optimized for Realistic Metrics) ---
    // Note: 'monthlyOld' and 'monthlyNew' are now calibrated to show ~50-60% efficiency gain (balanced view).
    const groupData = [
        {
            id: 'project', name: 'å°ˆæ¡ˆçµ„', color: '#00897B', monthlyOld: 14000, monthlyNew: 7000,
            desc: '<b>ã€æˆ°ç•¥æ¨ç´è½‰å‹ã€‘</b><br>å°ˆæ¡ˆçµ„å°å…¥ AI å¾Œï¼ŒæˆåŠŸå°‡æœƒè­°è¨˜éŒ„ã€è¡Œç¨‹ç¢ºèªèˆ‡åŸºç¤åˆç´„æ“¬å®šç­‰ã€Œè³‡è¨Šæ¬é‹ã€å·¥ä½œè‡ªå‹•åŒ–ï¼Œä½¿ PM èƒ½å¾ã€Œé€²åº¦è¿½è¹¤è€…ã€è½‰å‹ç‚ºã€Œè³‡æºæ•´åˆè€…ã€ã€‚<br><br>æˆ‘å€‘åˆ©ç”¨ AI <b>ç”Ÿæˆç•°æ¥­åˆä½œå¤¥ä¼´çš„ç´ æè¦ç¯„æ‰‹å†Š</b>ï¼Œè§£æ±ºä¾†å›æºé€šè¦æ ¼çš„ç—›é»ï¼›åˆ©ç”¨ Gemini <b>è‡ªå‹•å½™æ•´çµæ¡ˆå ±å‘Šæ•¸æ“š</b>ï¼Œå°‡ä¸‰å¤©çš„å·¥ä½œç¸®çŸ­è‡³åŠå¤©ï¼›æ›´åœ¨æ´»å‹•å‰æœŸ<b>å¿«é€Ÿç”¢å‡ºæ³¢æ®µæ´»å‹•ä¼åŠƒè‰æ¡ˆ</b>ï¼Œè®“åœ˜éšŠèƒ½å°‡ç²¾åŠ›é›†ä¸­åœ¨å‰µæ„èˆ‡å¯è¡Œæ€§çš„æ·±åº¦è¨è«–ä¸Šã€‚',
            tasks: [
                { name: "ä¾‹æœƒç°¡å ±è£½ä½œ", old: 90, new: 15, tool: "Gemini", cat: "Strategy", note: "è³‡æ–™å½™æ•´", freq: 20 },
                { name: "åˆä½œç­–ç•¥åˆ¶å®š", old: 120, new: 30, tool: "ChatGPT", cat: "Strategy", note: "ææ¡ˆç™¼æƒ³", freq: 10 },
                { name: "åˆç´„æ“¬å®š/å¯©é–±", old: 60, new: 15, tool: "Gemini", cat: "Ops", note: "é¢¨éšªåˆç¯©", freq: 5 },
                { name: "çµæ¡ˆå ±å‘Šè£½ä½œ", old: 240, new: 60, tool: "Gemini", cat: "Ops", note: "æ•¸æ“šåœ–è¡¨åŒ–", freq: 2 },
                { name: "ç•°æ¥­ç´ æç®¡ç†", old: 180, new: 30, tool: "Gemini", cat: "Ops", note: "è¦ç¯„æ‰‹å†Šç”Ÿæˆ", freq: 3 },
                { name: "æ–°èç¨¿æ’°å¯«", old: 60, new: 10, tool: "ChatGPT", cat: "Strategy", note: "æ–‡æ¡ˆç”¢å‡º", freq: 5 }
            ]
        },
        {
            id: 'digital', name: 'æ•¸ä½çµ„', color: '#0284c7', monthlyOld: 16000, monthlyNew: 6800, 
            desc: '<b>ã€æ•¸æ“šæ±ºç­–å‡ç´šã€‘</b><br>æ•¸ä½çµ„éå»å—é™æ–¼ç¹ç‘£çš„ç´ æä¸Šå‚³èˆ‡æ‰‹å‹•å ±è¡¨æ•´ç†ã€‚é€é XMP èˆ‡ Geminiï¼Œæˆ‘å€‘æ¶ˆé™¤äº†æ©Ÿæ¢°å¼æ“ä½œï¼Œå°‡ç”¢èƒ½è½‰ç§»è‡³<b>ç²¾ç´°åŒ–å—çœ¾åˆ†æ</b>èˆ‡<b>ç«¶å“ç´ æè§£æ§‹</b>ã€‚<br><br>ç¾åœ¨ï¼Œæˆ‘å€‘åˆ©ç”¨ AI æ‰¹é‡ç”Ÿæˆ<b>å¤šå°ºå¯¸ç´ æè®Šé«”</b>èˆ‡<b>æ–‡æ¡ˆæ¸¬è©¦çµ„</b>ï¼Œå¤§å¹…æå‡ A/B Testing çš„é »ç‡èˆ‡å»£åº¦ã€‚åŒæ™‚ï¼Œ<b>è‡ªå‹•åŒ–é€±å ±èˆ‡æœˆå ±</b>çš„ç”¢å‡ºï¼Œè®“è¡ŒéŠ·é ç®—èƒ½æ›´å³æ™‚ä¸”ç²¾æº–åœ°æŠ•æ”¾åœ¨é«˜è½‰æ›ç‡çš„æ¸ é“ä¸Šï¼Œå¯¦ç¾æ•¸æ“šé©…å‹•çš„ç²¾æº–è¡ŒéŠ·ã€‚',
            tasks: [
                { name: "å»£å‘Šæ–‡æ¡ˆæ’°å¯«", old: 60, new: 10, tool: "Gemini", cat: "Strategy", note: "è®Šé«”æ¸¬è©¦", freq: 50 },
                { name: "ç´ ææ‰¹é‡ä¸Šå‚³", old: 60, new: 10, tool: "XMP", cat: "Ops", note: "è‡ªå‹•æŠ•æ”¾", freq: 30 },
                { name: "å¤šå°ºå¯¸è®Šé«”è£½ä½œ", old: 120, new: 20, tool: "Nanobanana", cat: "Visual", note: "å¿«é€Ÿå»¶å±•", freq: 10 },
                { name: "å—çœ¾ç•«åƒåˆ†æ", old: 180, new: 30, tool: "Gemini", cat: "Strategy", note: "æ•¸æ“šæ´å¯Ÿ", freq: 8 },
                { name: "ç«¶å“ç´ æåˆ†æ", old: 120, new: 40, tool: "Manus", cat: "Ops", note: "è¶¨å‹¢æ­¸ç´", freq: 5 },
                { name: "æˆæ•ˆå ±å‘Šè£½ä½œ", old: 120, new: 20, tool: "Gemini", cat: "Ops", note: "é€±/æœˆå ±", freq: 4 }
            ]
        },
        {
            id: 'overseas', name: 'æµ·å¤–çµ„', color: '#d97706', monthlyOld: 13000, monthlyNew: 5500,
            desc: '<b>ã€å…¨çƒåŒ–åœ¨åœ°æ·±è€•ã€‘</b><br>æ–‡åŒ–ã€èªè¨€éš”é–¡èˆ‡å¸‚å ´ä¸ç†Ÿæ‚‰ï¼Œæ›¾ç¶“æ˜¯æ‹“å±•æµ·å¤–å¸‚å ´çš„æœ€å¤§é˜»åŠ›ï¼Œå¦‚ä»Š AI å”åŠ©æˆ‘å€‘è·¨è¶Šäº†é€™é“é–€æª»ï¼Œä»¥è¿‘ä¹å³æ™‚çš„é€Ÿåº¦è½‰æ›èˆ‡èª¿æŸ¥å¤šèªç³»å¸‚å ´çš„å…§å®¹ï¼Œåœ˜éšŠé‡å¿ƒç¾å·²ç§»è½‰è‡³<b>æ·±åŒ–åœ¨åœ°åŒ–è¡ŒéŠ·è¦åŠƒ</b>ï¼Œç¢ºä¿æ¯ä¸€å€‹è¡ŒéŠ·æ´»å‹•éƒ½èƒ½ç²¾æº–æ‰“å‹•ç•¶åœ°ç©å®¶ï¼ŒåŒæ™‚å°‡æ³•å¾‹åˆè¦é¢¨éšªé™è‡³æœ€ä½ã€‚',
            tasks: [
                { name: "å¸‚å ´è¶¨å‹¢ç ”ç©¶", old: 120, new: 60, tool: "Perplexity", cat: "Strategy", note: "å¸‚å ´èª¿ç ”", freq: 10 },
                { name: "æ–°èç¨¿/æ–‡ç« ", old: 90, new: 30, tool: "ChatGPT", cat: "Strategy", note: "æª¢æ ¸æ½¤é£¾", freq: 15 },
                { name: "ç¤¾åª’ç¶“ç‡Ÿ", old: 60, new: 15, tool: "Gemini", cat: "Ops", note: "ç”¢å‡ºèˆ‡ç›£æ§", freq: 30 },
                { name: "KOL/KOC åˆä½œ", old: 120, new: 40, tool: "Gemini", cat: "Strategy", note: "ç›£æ§èˆ‡åˆ†æ", freq: 5 }
            ]
        },
        {
            id: 'art', name: 'ç¾è¡“çµ„', color: '#9333ea', monthlyOld: 15000, monthlyNew: 5200,
            desc: '<b>ã€å‰µæ„ç”¢èƒ½è§£æ”¾ã€‘</b><br>ç¾è¡“çµ„å°å…¥ Nanobanana, Leonardo, VEO ç­‰é«˜éšç”Ÿæˆå·¥å…·ï¼Œå¾¹åº•æ”¹è®Šäº†ç´ æç”Ÿç”¢éˆã€‚éå»éœ€è€—æ™‚æ•¸å¤©çš„è‰åœ–ç™¼æƒ³èˆ‡ç´ æå»èƒŒï¼Œç¾åœ¨å¯å¿«é€Ÿå®ŒæˆåŸå‹é©—è­‰ã€‚é€™ä¸åƒ…å¤§å¹…æå‡äº†ç´ æç”¢å‡ºçš„ã€Œé‡ã€ï¼Œæ›´è®“ç¾è¡“äººå“¡æœ‰å……è£•æ™‚é–“æ‰“ç£¨ã€Œè³ªã€ï¼Œå°ˆæ³¨æ–¼<b>è¦–è¦ºé¢¨æ ¼å®šèª¿</b>èˆ‡<b>å‹•æ…‹è…³æœ¬å‰µæ„</b>ï¼Œå¯¦ç¾å‰µæ„åƒ¹å€¼çš„æœ€å¤§åŒ–ã€‚',
            tasks: [
                { name: "å¸¸æ…‹åœ–ç‰‡ç”Ÿæˆ", old: 240, new: 80, tool: "Nanobanana", cat: "Visual", note: "ç´ æè¼”åŠ©", freq: 20 },
                { name: "å‰µæ„å½±åƒç”¢å‡º", old: 480, new: 120, tool: "Leonardo", cat: "Visual", note: "åˆ†é¡æ¨¡æ“¬", freq: 10 },
                { name: "æœ¬åœ°æ¸¬è©¦ä¸²æ¥", old: 120, new: 70, tool: "ComfyUI", cat: "Visual", note: "å·¥ä½œæµå„ªåŒ–", freq: 5 },
                { name: "é«˜å“è³ªå»£å‘ŠçŸ­ç‰‡", old: 480, new: 240, tool: "VEO", cat: "Visual", note: "å½±ç‰‡ç”Ÿæˆ", freq: 5 },
                { name: "ç´ æå»èƒŒåˆæˆ", old: 30, new: 2, tool: "PS AI", cat: "Visual", note: "ä¸€éµè™•ç†", freq: 150 }
            ]
        }
    ];

    // --- Calculation & Logic ---
    let catCounts = { Strategy: 0, Visual: 0, Ops: 0 };
    let toolCountsGeneral = {};
    let toolCountsArt = {};
    let totalOld = 0, totalNew = 0;

    groupData.forEach(g => {
        g.tasks.forEach(t => {
            catCounts[t.cat] = (catCounts[t.cat] || 0) + t.freq;
            if (g.id === 'art') {
                toolCountsArt[t.tool] = (toolCountsArt[t.tool] || 0) + t.freq;
            } else {
                toolCountsGeneral[t.tool] = (toolCountsGeneral[t.tool] || 0) + t.freq;
            }
        });
        totalOld += g.monthlyOld; totalNew += g.monthlyNew;
    });

    const totalTasks = Object.values(catCounts).reduce((a,b)=>a+b, 0);
    const catPercentages = [
        Math.round(catCounts.Strategy / totalTasks * 100),
        Math.round(catCounts.Visual / totalTasks * 100),
        Math.round(catCounts.Ops / totalTasks * 100)
    ];

    // NOTE: Automatic KPI update removed to allow manual HTML edits to persist
    
    // --- Charts & DOM Generation ---
    
    // === CRITICAL FIX: STATIC MODE CHECK ===
    // If the group container already has content (because it was exported), DO NOT regenerate.
    if (document.getElementById('groupContainer').children.length === 0) {
        
        // 1. Tool Lists (NO BARS, JUST RANK)
        function renderToolList(countsObj, elementId, colorOverride) {
            const sorted = Object.entries(countsObj).sort((a,b) => b[1] - a[1]).slice(0, 5);
            const el = document.getElementById(elementId);
            
            sorted.forEach(([tool, count], index) => {
                let barColor = colorOverride || '#3b82f6';
                if (!colorOverride && ['XMP','Manus'].includes(tool)) barColor = '#f59e0b';
                
                el.innerHTML += `
                    <div class="tool-list-item">
                        <div class="tool-rank">#${index + 1}</div>
                        <div class="tool-name">
                            <span style="width:8px; height:8px; border-radius:50%; background:${barColor};"></span>
                            ${tool}
                        </div>
                    </div>
                `;
            });
        }
        renderToolList(toolCountsGeneral, 'topToolsGeneral', null);
        renderToolList(toolCountsArt, 'topToolsArt', '#9333ea');

        // 2. Group Cards
        const container = document.getElementById('groupContainer');
        groupData.forEach(g => {
            const card = document.createElement('div');
            card.className = 'group-card';
            card.style.borderTop = `5px solid ${g.color}`;
            
            const rows = g.tasks.map(t => {
                let catColor = t.cat === 'Strategy' ? '#3b82f6' : (t.cat === 'Visual' ? '#a855f7' : '#f59e0b');
                let catName = t.cat === 'Strategy' ? 'æ–‡æ¡ˆ' : (t.cat === 'Visual' ? 'è¦–è¦º' : 'æ•¸æ“š');
                let saved = t.old - t.new;
                return `<tr><td style="font-weight:600;"><span class="cat-badge" style="background:${catColor}">${catName}</span>${t.name}</td><td><span style="font-size:12px; color:#64748b;">${t.note}</span></td><td><span class="time-badge">${t.old}åˆ†</span></td><td><span class="time-badge ai">${t.new}åˆ†</span></td><td><span class="diff-badge">â¬‡ ${saved}åˆ†</span></td></tr>`;
            }).join('');

            const descHtml = `<div class="group-desc-box" style="border-left-color: ${g.color}"><div class="group-desc-title" style="color: ${g.color}"><i class="fa-solid fa-bullseye"></i> æ ¸å¿ƒè½‰å‹æˆæ•ˆ</div><div class="group-desc-text">${g.desc}</div></div>`;

            card.innerHTML = `
                <div class="group-header">
                    <div class="group-title" style="color: ${g.color}"><i class="fa-solid fa-layer-group"></i> ${g.name}</div>
                    <div class="group-stats">
                        <div class="stat-badge"><span style="color: ${g.color}">${(g.monthlyOld/g.monthlyNew).toFixed(1)}å€</span><label>æ•ˆç‡æå‡</label></div>
                        <div class="stat-badge"><span style="color: #10b981">${Math.round(((g.monthlyOld - g.monthlyNew) / g.monthlyOld) * 100)}%</span><label>å·¥æ™‚é‡‹æ”¾</label></div>
                    </div>
                </div>
                ${descHtml}
                <div class="group-content">
                    <div>
                        <h4 style="margin: 0 0 15px 0; color: #475569;">é‡é» AI æ‡‰ç”¨é …ç›®</h4>
                        <table class="task-table">
                            <thead><tr><th>ä»»å‹™é …ç›®</th><th>æ‡‰ç”¨ç°¡è¿°</th><th>å‚³çµ±</th><th>AI</th><th>å–®æ¬¡ç¯€çœ</th></tr></thead>
                            <tbody>${rows}</tbody>
                        </table>
                    </div>
                    <div class="gallery-wrapper">
                        <h4 style="margin: 0 0 5px 0; color: #475569;">æˆæœå±•ç¤ºç•«å»Š</h4>
                        <div class="img-add-btn" onclick="document.getElementById('file-${g.id}').click()" style="display: flex;">
                            <input type="file" id="file-${g.id}" accept="image/*" multiple style="display:none" onchange="handleImageUpload(this, '${g.id}')">
                            <i class="fa-solid fa-cloud-arrow-up" style="font-size: 30px; margin-bottom: 10px;"></i>
                            <span style="font-weight: 600;">é»æ“Šæ–°å¢åœ–ç‰‡</span>
                        </div>
                        <div class="gallery-grid" id="gallery-${g.id}"></div>
                    </div>
                </div>
            `;
            container.appendChild(card);
        });
    }

    // --- Charts (Always run to repaint canvas) ---
    new Chart(document.getElementById('categoryChart').getContext('2d'), {
        type: 'doughnut',
        data: { labels: ['æ–‡æ¡ˆèˆ‡ç­–ç•¥', 'è¦–è¦ºèˆ‡å½±éŸ³', 'ç‡Ÿé‹èˆ‡æ•¸æ“š'], datasets: [{ data: catPercentages, backgroundColor: ['#3b82f6', '#a855f7', '#f59e0b'], borderWidth: 0 }] },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { color: '#fff', font: { weight: 'bold' }, formatter: (v) => v + '%' } }, cutout: '65%' },
        plugins: [ChartDataLabels]
    });

    new Chart(document.getElementById('valueShiftChart').getContext('2d'), {
        type: 'bar',
        data: { labels: groupData.map(g => g.name), datasets: [{ label: 'å‚³çµ± P3/P4', data: groupData.map(g => (g.monthlyOld * 0.55 / 60).toFixed(0)), backgroundColor: '#ef4444', stack: 'Before' }, { label: 'å‚³çµ± P1/P2', data: groupData.map(g => (g.monthlyOld * 0.45 / 60).toFixed(0)), backgroundColor: '#0369a1', stack: 'Before' }, { label: 'AIå¾Œ P3/P4', data: groupData.map(g => (g.monthlyNew * 0.65 / 60).toFixed(0)), backgroundColor: '#fca5a5', stack: 'After' }, { label: 'AIå¾Œ P1/P2', data: groupData.map(g => (168 - (g.monthlyNew * 0.65 / 60)).toFixed(0)), backgroundColor: '#0ea5e9', stack: 'After' }] },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false } }, y: { max: 180, title: { display: true, text: 'å°æ™‚ (Hours)' } } } }
    });

    // --- Helper Functions ---
    function handleImageUpload(input, id) {
        if (input.files && input.files.length > 0) {
            const gallery = document.getElementById(`gallery-${id}`);
            Array.from(input.files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const div = document.createElement('div');
                    div.className = 'gallery-item';
                    div.setAttribute('onclick', "viewImage(this.querySelector('img').src)");
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    div.appendChild(img);
                    gallery.appendChild(div);
                };
                reader.readAsDataURL(file);
            });
        }
    }

    window.viewImage = function(src) {
        document.getElementById("myLightbox").style.display = "flex";
        document.getElementById("img01").src = src;
    }
    window.closeLightbox = function() {
        document.getElementById("myLightbox").style.display = "none";
    }

    function saveOfflineFile() {
        const clone = document.documentElement.cloneNode(true);
        // Add static mode class to body of clone - This is the KEY FIX
        const bodyClone = clone.querySelector('body');
        if (bodyClone) bodyClone.classList.add('static-mode');
        
        // Remove UI controls
        const fab = clone.querySelector('.fab-container');
        if(fab) fab.remove();
        const uploadBtns = clone.querySelectorAll('.img-add-btn');
        uploadBtns.forEach(btn => btn.style.display = 'none');
        const lb = clone.querySelector('.lightbox');
        if(lb) lb.style.display = 'none';

        const htmlContent = "<!DOCTYPE html>\n" + clone.outerHTML;
        const blob = new Blob([htmlContent], { type: 'text/html' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        const dateStr = new Date().toISOString().split('T')[0];
        link.download = `è¡ŒéŠ·éƒ¨AIå ±å‘Š_æœ€çµ‚ä¿®æ­£ç‰ˆ_${dateStr}.html`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        alert("åŒ¯å‡ºæˆåŠŸï¼");
    }
</script>
</body>
</html>